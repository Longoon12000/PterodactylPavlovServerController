@page "/rcon"
@inherits FluxorComponent

@using Fluxor
@using Fluxor.Blazor.Web.Components
@using PterodactylPavlovServerController.Services
@using PterodactylPavlovServerController.Store.Servers
@using PterodactylPavlovServerDomain.Models

@inject IDispatcher Dispatcher
@inject IState<PterodactylServersState> ServersState

<h3>Select a server</h3>

@if (ServersState.Value.Servers == null)
{
    <div class="spinner-border text-info" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
}
else
{
    @foreach (PterodactylServerModel server in ServersState.Value.Servers)
    {
        <ServerSelectorComponent ServerId="@server.ServerId" />
    }
}

@code {
    protected override void OnInitialized()
    {
        if (ServersState.Value.Servers == null)
        {
            Dispatcher.Dispatch(new PterodactylServersLoadAction());
        }

        base.OnInitialized();
    }
}